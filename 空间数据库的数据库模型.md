# 空间数据库的数据库模型

## 数据模型

    是数据库系统中关于数据和联系的逻辑组织的形式表示。

能反映事务的固有特征及其相互联系或运动变化规律。每一种数据模型都以不同的数据抽象与表示能力来反映客观事物，有其不同的处理数据联系的方式。

### 数据模型的基本组成

1. 数据结构

    是指对实体类型和实体间联系的表达实现；是数据模型最基本的组织部份，规定了数据模型的静态特性。

2. 数据操作

    是指对数据库进行的检索和更新两类操作。

3. 数据的约束条件

    是一组完整性规则的集合。它定义了给定数据模型中数据及其联系应具有的制约和依赖规则。

## E-R数据模型

    面向现实世界，而不是面向实现。

### E-R数据模型的基本概念

1. 实体（Entity)：是客观存在的且可以区别的事物
2. 联系（Relationship）：实体与实体间的关系抽象表示
   1. 二元联系：只有两个实体参与的联系称为二元联系，包括1:1，1:n，m:n
   2. 多元联系：参与联系的实体个数>=3
   3. 自反联系：标识同一个实体集两部分实体之间的联系，是一种特殊的二元联系
3. 属性：实体或联系所具有的特征称为属性

   - 一个实体可以由多个属性组成和描述，但在数据库设计中通常只选择部分数据管理需要的属性
   - 属性往往是不可再细分的原子值
   - 属性有型和值的区别
   - 每一个属性都有一定的变化范围，通常称属性取值的变化范围为属性的域
   - 能唯一标识实体集中某一实体的属性或属性组称为实体集的标识关键字或称关键字

### E-R图

## 层次数据模型

### 层次模型的数据结构

    满足以下两个条件的基本层次联系的集合为层次模型.

1. 有且只有一个结点无父节点，称之为根节点
2. 根节点以外其他结点有且只有一个父节点
   1. 每个结点标识一个记录类型（实体性）
   2. 记录间的联系用有向线表示，仅表示1：n

在层次模型中表示m:n的关系需要产生大量的冗余结点，因为树中实体间的联系是单一的。

### 层次模型的数据操纵与完整性约束

### 层次模型的存储结构

不仅存储数据内容，还要存数据之间的层次联系

1. 邻接法

    按照层次树前序穿越的顺序把所有记录依次邻接存放（自顶向下，自左向右），称为层次序列顺序。

2. 链接法

    用指引元来反映数据间的层次联系

   - 子女-兄弟指引元

        每个记录设两个指引元，一个指向最大（最左）子女，一个指向最邻近兄弟

   - 层次序列法

        每个记录设一个指引元，当有最左子女时指向最左子女，否则当有兄弟时指向最邻近兄弟，否则指向双亲结点的最邻近兄弟结点。

### 层次模型的优缺点

1. 优点
   1. 结构简单。
   2. 对于一些树状结构的系统，其性能较好且联系固定。
   3. 提供了良好的完整性支撑。
   4. 记录间的联系通过指针来实现，查询效率高。
2. 缺点
   1. 对于m:n或网状结构的表示方法很笨拙，会产生大量冗余结点。
   2. 增加、删除、修改结点的限制多。
   3. 查询只能通过双亲结点进行。
   4. 结构严密、层次命令趋于程序化、编写复杂。

## 网状数据模型

### 网状模型的数据结构

    满足以下两个条件的基本层次联系的集合称为网状模型。

1. 允许有一个以上的父节点
2. 其他结点可以有多于一个的双亲结点

网状模型对m:n的表示相对层次模型更加方便。

### 网状模型的数据操纵与完整性约束

### 网状模型的存储结构

1. 链接法：以系值为单位
   1. 系型：一个1:m为一个系型，有首记录型、属记录型
   2. 系值；一个首记录值和其所属的所有属记录值。
   3. 代表结构：单向循环链、双向循环链、单向环转向首链、双向环转向首链
        - 特点：指针的增加加快了存取速度，减少了故障影响，但同时也需要动态保持和维护这种复杂架构，势必会影响系统的复杂度，耗用大量的存储空间

2. 指针阵列法

    所有指向属记录的指针嵌入系首记录中，形成一个排了序的指针。

### 网状模型的优缺点

1. 优点
   1. 更直接地描述客观世界。
   2. 性能良好，存储效率高。
2. 缺点
   1. 结构复杂。
   2. 其DDL、DML语言复杂不易使用。

## 关系数据模型

### 关系模型的基本概念

- 属性
- 域
- 关系
- 元组
- 键

### 关系模型的数据结构

- 用二维表格表示实体集及其属性
  - 不仅可以用二维表表示实体集，还可以用于描述实体集的联系

### 关系的性质

- 关系是一个二维表，表中的每一行对应一个元组，表中的每一列有一个属性名且对应一个域。
- 列是同质的，即每一列的值来自同一个域。
- 关系中的每一个属性是不可再分解的，即所有域都应是原子数据的集合。
- 关系中任意两个元组不能完全相同。
- 关系中行的排列顺序、列的排序顺序是无关紧要的。
- 每个关系都有关键字的属性集唯一标识各个元组。

### 关系模式

    R(U,D,DOM,I,Σ)->R(U)

### 关系模型的数据约束

1. 域完整性约束->取值范围和是否可为NULL
2. 实体完整性约束->主键唯一且不为NULL
3. 参照完整性约束->对引用的限制

### 关系模型的优缺点

1. 优点
   1. 坚实的理论基础。
   2. 关系模型中的二维表不仅可以表示实体集，还可以表示实体之间的联系。
   3. 数据的表示方法统一、简单、便于计算机实现、方便用户使用。
   4. 数据独立性高->物理独立性和逻辑独立性
2. 缺点
   1. 查询效率不如非关系模型
   2. 不能以自然的方式表示实体集间的联系
   3. 语义信息不足
   4. 数据类型过少

### 关系模型用于空间数据库时的局限性

1. 对地理实体进行的不自然的分解。
2. 一般的RDBMS只允许记录设为固定长度，而空间数据通常是变长的。
3. 一般的RDBMS难以存储和维护空间数据的拓扑关系。
4. 一般的RDBMS难以实现对空间数据的关联、连通、包含、叠加等基本操作。
5. 一般的RDBMS不能支持GIS需要的一些复杂图像功能。
6. 一般的RDBMS难以支持复杂的地理信息，因为单个地理实体的表达需要多个文件、多条记录，包括大地网、特征坐标、拓扑关系、属性和非空间专题属性等方面的信息。

## 面向对象模型

### 对象

    含有数据和操作方法的独立模块，可以认为是数据和行为的统一体，表现在以下三个方面：
        1. 具有一个唯一的标识，以表明其存在的独立性；
        2. 具有一组描述特征的属性，以表明其在某一时刻的状态；
        3. 具有一组表示行为的操作方法，用以改变对象的状态。

1. 对象的定义

    一个对象Obeject可定义成一个三元组：

        Obeject = (ID, S, M)
    其中ID为对象标识；M为方法集；S为对象的内部状态，它可以直接是一个属性值，也可以是另一组对象的集合，因而它明显地表现出对象的递归。

2. 对象的基本特性
   1. 封装性
   2. 隐蔽性
   3. 稳定性

3. 消息

### 分类

    指把一组具有相同树形结构和操作方法的对象归纳或映射为一个公共类的流程。

- 类的层次结构->属性和方法的继承
  - 超类/子类之间的关系体现了“IS A”的语义
    - 超类是子类的抽象（Generalization）或概括
    - 子类是超类的特殊化（Specialization）或具体化
  - 类可以动态扩展，一个新的子类能从一个或多个已有类导出

### 概括

    将相同特征和操作的类再抽象为一个更高层次、更具一般性的超类的过程。

一个类可能是超类的子类，也有可能是几个子类的超类。所以，概括可能有任意多层次。概括技术避免了说明和存储上的大量冗余。这需要一种能自动地从子类的属性和操作中获取超类对象的属性和操作的机制，即继承机制。

>在开发时写了多个自定义类，后期发现多个类中含有相同的代码，此时可以抽取一个父类

### 继承

    一类对象可继承另一类对象的特性和能力。

子类继承父类的共性，而继承不仅可以把父类的特征传给中间子类，还可以向下传给中间子类的子类。父类可以继承子类，它服务于概括。继承机制减少代码冗余，减少相互间的接口和界面。

- 单继承和多继承
  - 单继承

    一个子类只能继承一个超类的特性（包括属性和方法）。其层次结构图是一棵树。
  - 多重继承

    一个子类能继承多个超类的特性（包括属性和方法）。其层次结构图是一个带根的有向无回路图。

- 继承的特点
  - 是建模的有力工具，提供了对现实世界简明而精确的描述；
  - 提供了信息重用机制。

- 子类与超类的冲突

    子类在定义自己特殊属性和方法时可能与继承下来的超类的属性和方法发生冲突->Override

### 联合

    在定义对象时，将同一类对象中的几个具有相同属性值的对象组合起来，为了避免重复，设立一个更高水平的对象来表示那些相同的属性值。

### 聚集

    将几个不同特征的简单对象组合成一个复杂的对象。

>namespace

每个不同特征的对象是该符合对象的一部分，他们有自己的属性描述数据和操作，这些不能为复合对象所共有，但复合对象可以从它们那里得到一些信息。

### 传播

    复杂对象的某些属性子不单独存于数据库中，而由子对象派生或提取，将子（成员）对象的属性信息强制地传播给综合复杂对象。

成员对象的属性只存储一次，保证数据一致性和减少冗余。

### 嵌套

    一个对象的属性可以是一个对象，这样对象之间产生一个嵌套层次结构。

## 面向对象数据模型

### 数据结构

    用对象结构以及类间继承和组合关系建立数据间的复杂结构关系。

这种模式结构的语义表达能力远比E-R方法更强。

### 数据操纵

    用对象与类中方法构造模式上的操作。

这种操作语义范围远比传统数据模型要强。

### 数据约束

    数据约束也是一种方法，可以用类中方法表示数据约束。

### OODBS的基本标准

1. 是一个面向对象系统

    其出发点是针对面向对象程序设计语言的持久性对象存储管理，其核心是充分支持完整地面向对象概念和机制，例如用户自定义数据类型、自定义函数、对象封装等必不可少的OO方法特征，与当前流行的OO程序设计语言取得一致
2. 是一个数据系统

    借助扩充传统数据库语义，使之与核心OO数据模型协调，以支持传统数据库系统中的所有数据库特征和功能，例如持久性、数据共享、事务管理、一致性控制及恢复等

>OODBS = 面向系统能力 + 数据库能力

### OODBS的的基本特点

1. 利用类来描述复杂的对象
2. 利用类中的封装的方法来模拟对象的复杂行为
3. 利用继承性来实现对象的结构和方法的重用

>正是由于这些特点，使得OODMS对一些特定应用领域（如CAD、GIS等），能较好地满足其应用需求。当然，这种纯粹的面向对象数据库系统并不支持SQL语言，在通用性方面失去了优势，因此其应用领域受到了很大的限制。

### 面向对象数据模型的优点

1. 适合处理各种各样的数据类型

   与传统的数据库（如层次、网状或关系）不同，面向对象数据库适合存储不同类型的数据，例如，图片、声音、视频，包括文本、数字等。

2. 面向对象程序设计与数据库技术相结合

    面向对象数据模型结合了面向对象程序设计与数据库技术，因而提供了一个集成应用开发系统。

3. 提高开发效率

    面向对象数据模型提供强大的特性，例如继承、多态和动态绑定，这样允许用户不用编写特定对象的代码就可以构成对象并提供解决方案。这些特性能有效地提高数据库应用程序开发人员的开发效率。

4. 改善数据访问

    面向对象数据模型明确地表示联系，支持导航式和关联式两种方式的信息访问。它比基于关系值的联系更能提高数据访问性能。

### 面向对象数据模型的缺点

1. 没有明确的定义

    很难提供一个准确的定义来说明面向对象DBMS应建成什么样，这是因为该名称已经应用到很多不同的产品和原型中，而这些产品和原型考虑的方面可能不一样。

2. 维护困难

    随着组织信息需求的改变，对象的定义也要求改变并且需移植现有数据库，以完成新对象的定义。当改变对象的定义和移植数据库时，它可能面临真正的挑战。

3. 不适合所有的应用

    面向对象数据模型用于需要管理数据对象之间存在的复杂关系的应用，它们特别适合于特定的应用，例如工程、电子商务、医疗等，但并不适合所有应用。当用于普通应用时，其性能会降低并要求很高的处理能力。

|内容|关系数据模型|面向对象数据模型|
|:-|:-|:-|
|基本数据结构|二维表|类|
|数据标识符|码|OID|
|静态性质|属性|属性|
|动态行为|关系操作|方法|
|抽象数据类型|无|有|
|封装性|无|有|
|数据间关系|主外码联系，数据以来|继承、组合|
|模式演化能力|弱|强|

## 时空数据模型

## 三维空间数据模型
